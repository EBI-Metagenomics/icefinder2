var jsonData = {'xData': [528.807, 528.857, 528.907, 528.957, 529.007, 529.057, 529.107, 529.157, 529.207, 529.257, 529.307, 529.357, 529.407, 529.457, 529.507, 529.557, 529.607, 529.657, 529.707, 529.757, 529.807, 529.857, 529.907, 529.957, 530.007, 530.057, 530.107, 530.157, 530.207, 530.257, 530.307, 530.357, 530.407, 530.457, 530.507, 530.557, 530.607, 530.657, 530.707, 530.757, 530.807, 530.857, 530.907, 530.957, 531.007, 531.057, 531.107, 531.157, 531.207, 531.257, 531.307, 531.357, 531.407, 531.457, 531.507, 531.557, 531.607, 531.657, 531.707, 531.757, 531.807, 531.857, 531.907, 531.957, 532.007, 532.057, 532.107, 532.157, 532.207, 532.257, 532.307, 532.357, 532.407, 532.457, 532.507, 532.557, 532.607, 532.657, 532.707, 532.757, 532.807, 532.857, 532.907, 532.957, 533.007, 533.057, 533.107, 533.157, 533.207, 533.257, 533.307, 533.357, 533.407, 533.457, 533.507, 533.557, 533.607, 533.657, 533.707, 533.757, 533.807, 533.857, 533.907, 533.957, 534.007, 534.057, 534.107, 534.157, 534.207, 534.257, 534.307, 534.357, 534.407, 534.457, 534.507, 534.557, 534.607, 534.657, 534.707, 534.757, 534.807, 534.857, 534.907, 534.957, 535.007, 535.057, 535.107, 535.157, 535.207, 535.257, 535.307, 535.357, 535.407, 535.457, 535.507, 535.557, 535.607, 535.657, 535.707, 535.757, 535.807, 535.857, 535.907, 535.957, 536.007, 536.057, 536.107, 536.157, 536.207, 536.257, 536.307, 536.357, 536.407, 536.457, 536.507, 536.557, 536.607, 536.657, 536.707, 536.757, 536.807, 536.857, 536.907, 536.957, 537.007, 537.057, 537.107, 537.157, 537.207, 537.257, 537.307, 537.357, 537.407, 537.457, 537.507, 537.557, 537.607, 537.657, 537.707, 537.757, 537.807, 537.857, 537.907, 537.957, 538.007, 538.057, 538.107, 538.157, 538.207, 538.257, 538.307, 538.357, 538.407, 538.457, 538.507, 538.557, 538.607, 538.657, 538.707, 538.757, 538.807, 538.857, 538.907, 538.957, 539.007, 539.057, 539.107, 539.157, 539.207, 539.257, 539.307, 539.357, 539.407, 539.457, 539.507, 539.557, 539.607, 539.657, 539.707, 539.757, 539.807, 539.857, 539.907, 539.957, 540.007, 540.057, 540.107, 540.157, 540.207, 540.257, 540.307, 540.357, 540.407, 540.457, 540.507, 540.557, 540.607, 540.657, 540.707, 540.757, 540.807, 540.857, 540.907, 540.957, 541.007, 541.057, 541.107, 541.157, 541.207, 541.257, 541.307, 541.357, 541.407, 541.457, 541.507, 541.557, 541.607, 541.657, 541.707, 541.757, 541.807, 541.857, 541.907, 541.957, 542.007, 542.057, 542.107, 542.157, 542.207, 542.257, 542.307, 542.357, 542.407, 542.457, 542.507, 542.557, 542.607, 542.657, 542.707, 542.757, 542.807, 542.857, 542.907, 542.957, 543.007, 543.057, 543.107, 543.157, 543.207, 543.257, 543.307, 543.357, 543.407, 543.457, 543.507, 543.557, 543.607, 543.657, 543.707, 543.757, 543.807, 543.857, 543.907, 543.957, 544.007, 544.057, 544.107, 544.157, 544.207, 544.257, 544.307, 544.357, 544.407, 544.457, 544.507, 544.557, 544.607, 544.657, 544.707, 544.757, 544.807, 544.857, 544.907, 544.957, 545.007, 545.057, 545.107, 545.157, 545.207, 545.257, 545.307, 545.357, 545.407, 545.457, 545.507, 545.557, 545.607, 545.657, 545.707, 545.757, 545.807, 545.857, 545.907, 545.957, 546.007, 546.057, 546.107, 546.157, 546.207, 546.257, 546.307, 546.357, 546.407, 546.457, 546.507, 546.557, 546.607, 546.657, 546.707, 546.757, 546.807, 546.857, 546.907, 546.957, 547.007, 547.057, 547.107, 547.157, 547.207, 547.257, 547.307, 547.357, 547.407, 547.457, 547.507, 547.557, 547.607, 547.657, 547.707, 547.757, 547.807, 547.857, 547.907, 547.957, 548.007, 548.057, 548.107, 548.157, 548.207, 548.257, 548.307, 548.357, 548.407, 548.457, 548.507, 548.557, 548.607, 548.657, 548.707, 548.757, 548.807, 548.857, 548.907, 548.957, 549.007, 549.057, 549.107, 549.157, 549.207, 549.257, 549.307, 549.357, 549.407, 549.457, 549.507, 549.557, 549.607, 549.657, 549.707, 549.757, 549.807, 549.857, 549.907, 549.957, 550.007, 550.057, 550.107, 550.157, 550.207, 550.257, 550.307, 550.357, 550.407, 550.457, 550.507, 550.557, 550.607, 550.657, 550.707, 550.757, 550.807, 550.857, 550.907, 550.957, 551.007, 551.057, 551.107, 551.157, 551.207, 551.257, 551.307, 551.357, 551.407, 551.457, 551.507, 551.557, 551.607, 551.657, 551.707, 551.757, 551.807, 551.857, 551.907, 551.957, 552.007, 552.057, 552.107, 552.157, 552.207, 552.257, 552.307, 552.357, 552.407, 552.457, 552.507, 552.557, 552.607, 552.657, 552.707, 552.757, 552.807, 552.857, 552.907, 552.957, 553.007, 553.057, 553.107, 553.157, 553.207, 553.257, 553.307, 553.357, 553.407, 553.457, 553.507, 553.557, 553.607, 553.657, 553.707, 553.757, 553.807, 553.857, 553.907, 553.957], 'datasets': [{'name': '', 'data': [50.8, 48.6, 49.6, 49.6, 46.8, 45.6, 45.2, 44.0, 42.6, 40.6, 38.0, 37.6, 34.8, 33.0, 33.0, 33.2, 32.2, 31.8, 31.4, 30.8, 31.2, 30.6, 29.2, 28.8, 29.2, 29.0, 30.4, 30.4, 30.6, 31.0, 31.6, 32.8, 33.0, 33.2, 33.8, 32.6, 31.6, 31.6, 30.8, 31.0, 30.8, 30.2, 30.6, 30.6, 31.0, 31.8, 30.8, 30.4, 30.2, 29.6, 29.6, 29.2, 29.6, 30.0, 29.8, 28.8, 30.8, 31.0, 32.2, 33.6, 34.4, 35.6, 35.4, 35.2, 35.4, 35.8, 35.0, 36.6, 36.4, 35.8, 36.2, 37.8, 37.6, 36.0, 35.0, 35.2, 36.4, 36.2, 36.6, 37.4, 37.6, 37.2, 37.2, 40.2, 40.2, 39.4, 38.8, 38.2, 37.4, 36.0, 34.8, 33.8, 34.4, 32.8, 33.8, 35.0, 35.8, 37.0, 38.2, 39.2, 39.2, 38.0, 37.8, 39.4, 39.6, 39.8, 39.0, 39.6, 39.2, 42.4, 45.2, 47.0, 47.4, 45.8, 45.2, 45.6, 46.2, 45.4, 46.0, 41.8, 39.2, 38.6, 38.4, 38.6, 38.8, 37.6, 37.6, 37.4, 36.6, 37.8, 38.4, 37.8, 38.0, 39.4, 40.2, 42.8, 43.6, 44.0, 43.4, 42.8, 41.6, 41.2, 40.4, 39.2, 39.2, 36.6, 34.8, 34.0, 35.2, 35.6, 36.4, 37.4, 38.0, 38.0, 36.4, 36.4, 37.0, 38.2, 38.6, 38.2, 38.0, 37.6, 37.6, 37.4, 37.8, 37.8, 37.2, 35.2, 35.0, 34.4, 34.6, 33.6, 33.4, 34.6, 34.2, 34.2, 33.6, 36.0, 35.4, 35.6, 37.0, 39.2, 40.2, 39.2, 39.8, 40.2, 41.4, 38.6, 38.0, 38.2, 36.4, 36.4, 35.2, 34.2, 33.2, 34.2, 34.6, 35.4, 35.6, 35.8, 37.4, 36.2, 36.6, 38.4, 39.4, 38.6, 38.0, 39.0, 40.4, 39.8, 39.0, 39.6, 40.2, 39.4, 40.0, 41.0, 41.6, 41.8, 41.0, 41.0, 40.0, 38.6, 39.6, 40.0, 39.6, 39.4, 39.6, 38.8, 38.2, 39.2, 40.0, 41.8, 39.8, 40.4, 40.0, 40.2, 39.0, 39.2, 39.6, 39.0, 38.8, 38.0, 38.4, 37.2, 36.6, 35.8, 36.2, 35.6, 35.8, 37.6, 37.8, 38.4, 39.0, 39.4, 39.0, 39.6, 40.6, 41.4, 42.0, 40.4, 40.6, 39.0, 38.0, 37.2, 37.0, 36.8, 35.4, 35.0, 34.8, 35.4, 34.8, 35.4, 36.4, 36.2, 38.8, 39.0, 41.0, 41.6, 41.2, 40.2, 40.2, 40.2, 40.0, 40.8, 40.0, 39.2, 37.4, 36.6, 36.6, 37.6, 37.4, 38.0, 38.0, 38.2, 37.4, 37.2, 37.2, 37.4, 38.2, 38.6, 39.4, 39.8, 40.4, 40.2, 40.2, 40.6, 41.6, 42.0, 40.6, 41.4, 41.8, 41.2, 42.0, 42.4, 42.8, 42.0, 41.2, 40.0, 39.2, 37.0, 36.2, 36.6, 35.0, 34.6, 33.8, 34.6, 33.4, 33.0, 34.2, 34.0, 33.6, 32.8, 31.0, 32.4, 33.4, 32.6, 32.4, 32.4, 31.8, 31.6, 30.6, 30.4, 32.4, 31.2, 29.8, 29.8, 31.0, 31.2, 31.0, 30.6, 30.0, 30.6, 29.0, 29.4, 29.8, 28.4, 28.4, 27.8, 28.4, 29.2, 29.6, 29.6, 30.2, 29.0, 29.0, 29.8, 29.2, 30.2, 30.4, 30.6, 31.0, 30.4, 31.4, 31.6, 31.8, 31.8, 31.4, 31.4, 30.2, 30.0, 30.2, 30.2, 29.4, 29.2, 29.6, 29.2, 31.2, 30.2, 29.2, 29.0, 29.2, 29.6, 30.2, 30.0, 28.8, 29.8, 28.2, 28.4, 29.2, 28.2, 27.4, 26.4, 27.4, 27.6, 27.8, 27.4, 28.2, 29.4, 29.6, 31.2, 33.2, 32.8, 30.4, 33.4, 34.2, 35.6, 36.0, 36.0, 36.2, 36.4, 35.6, 36.6, 37.0, 35.8, 35.6, 34.0, 34.0, 34.0, 35.4, 36.0, 37.4, 39.6, 39.6, 40.4, 40.8, 42.6, 41.8, 43.0, 42.6, 42.0, 39.0, 35.6, 35.8, 32.8, 31.4, 29.2, 29.0, 28.6, 27.8, 26.6, 27.8, 28.8, 28.4, 28.2, 29.2, 31.0, 30.4, 29.0, 29.0, 30.8, 30.4, 30.8, 31.4, 33.2, 32.6, 31.4, 31.6, 31.2, 31.2, 31.0, 32.8, 33.2, 33.8, 32.8, 33.8, 35.4, 36.8, 38.4, 38.6, 37.4, 35.6, 35.0, 34.2, 33.8, 34.2, 34.0, 32.0, 30.2, 30.4, 29.6, 29.4, 30.6, 30.4, 32.0, 31.2, 30.0, 31.6, 33.4, 33.2, 35.2, 36.2, 36.0, 37.0, 35.0], 'unit': '%', 'type': 'line', 'valueDecimals': 1}]};
let container = document.getElementById('gcmap'),
  highlightPoint = function(e) {
    var chart,
      point,
      i,
      event;
    for (i = 0; i < Highcharts.charts.length; i = i + 1) {
      chart = Highcharts.charts[i];
      // Find coordinates within the chart
      event = chart.pointer.normalize(e);
      // Get the hovered point
      point = chart.series[0].searchPoint(event, true);
      if (point) {
        point.highlight(e);
      }
    }
  };
['mousemove', 'touchmove', 'touchstart'].forEach(function (eventType) {
  container.addEventListener(
    eventType,
    function (e) {
      highlightPoint(e);
    }
  );
});
/**
 * 重写内部的方法， 这里是将提示框即十字准星的隐藏函数关闭
 */
Highcharts.Pointer.prototype.reset = function () {
  return undefined;
};
/**
 * 高亮当前的数据点，并设置鼠标滑动状态及绘制十字准星线
 */
Highcharts.Point.prototype.highlight = function (event) {
  this.onMouseOver(); // 显示鼠标激活标识
  this.series.chart.tooltip.refresh(this); // 显示提示框
  this.series.chart.xAxis[0].drawCrosshair(event, this); // 显示十字准星线
};
/**
 * 同步缩放效果，即当一个图表进行了缩放效果，其他图表也进行缩放
 */
function syncExtremes(e) {
  var thisChart = this.chart;
  if (e.trigger !== 'syncExtremes') { 
    Highcharts.each(Highcharts.charts, function (chart) {
      if (chart !== thisChart) {
        if (chart.xAxis[0].setExtremes) { 
          chart.xAxis[0].setExtremes(e.min, e.max, undefined, false, { trigger: 'syncExtremes' });
        }
      }
    });
  }
}
// 使用定义的JSON数据
var activity = jsonData;

activity.datasets.forEach(function (dataset, i) {
  // Add X values
  dataset.data = Highcharts.map(dataset.data, function (val, j) {
    return [activity.xData[j], val];
  });
  var chartDiv = document.createElement('div');
  chartDiv.className = 'chart';
  container.appendChild(chartDiv);
  Highcharts.chart(chartDiv, {
    chart: {
      width: 990,
      height: 200,
      marginLeft: 45, // Keep all charts left aligned
      spacingTop: 20,
      spacingBottom: 20
    },
    title: {
      text: dataset.name,
      align: 'left',
      margin: 0,
      x: 30
    },
    credits: {
      enabled: false
    },
    legend: {
      enabled: false
    },
    xAxis: {
      crosshair: true,
      events: {
        setExtremes: syncExtremes
      },
      labels: {
        format: '{value} k'
      }
    },
    yAxis: {
      title: {
        text: null
      }
    },
    tooltip: {
      positioner: function () {
        return {
          // right aligned
          x: this.chart.chartWidth - this.label.width,
          y: 10 // align to title
        };
      },
      borderWidth: 0,
      backgroundColor: 'none',
      pointFormat: '{point.y}',
      headerFormat: '',
      shadow: false,
      style: {
        fontSize: '12px'
      },
      valueDecimals: dataset.valueDecimals
    },
    series: [{
      data: dataset.data,
      name: dataset.name,
      type: dataset.type,
      lineWidth:1,
      color: Highcharts.getOptions().colors[i],
      fillOpacity: 0.3,
      tooltip: {
        valueSuffix: ' ' + dataset.unit
      }
    }]
  });
});
